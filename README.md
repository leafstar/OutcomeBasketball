

# OutcomeBasketball

Master Project

Using INLA to predict the outcome of basketball matches.

games2021_v2.csv: adding the average statistics before the current game in this season for both teams. 

Dataset Specification: mm/dd/yyyy

| Season | Starting date | Ending date | Playoff starts |
| ------ | ------------- | ----------- | -------------- |
| 2021   | 10/3/2021     | 3/12/2022   |                |
| 2020   | 12/11/2020    | 7/20/2021   |                |
| 2019   | 10/4/2019     | 10/11/2020  |                |
| 2018   | 9/28/2018     | 6/13/2019   |                |
| 2017   | 9/30/2017     | 6/8/2018    |                |
| 2016   | 10/1/2016     | 6/12/2017   |                |
| 2015   | 10/2/2015     | 6/19/2016   |                |
| 2014   | 10/4/2014     | 6/16/2015   |                |
| 2013   | 10/5/2013     | 6/15/2014   |                |
| 2012   | 10/6/2012     | 6/20/2013   |                |
| 2011   | 12/16/2011    | 6/21/2012   |                |
| 2010   | 10/4/2010     | 6/12/2011   |                |
| 2009   | 10/1/2009     | 6/17/2010   |                |
| 2008   | 10/5/2008     | 6/14/2009   |                |
| 2007   | 10/6/2007     | 6/17/2008   |                |
| 2006   | 10/9/2006     | 6/14/2007   |                |
| 2005   | 10/10/2005    | 6/20/2006   |                |
| 2004   | 10/22/2004    | 6/23/2005   |                |
| 2003   | 10/5/2003     | 6/15/2004   |                |

experiment record:

## 1.single season

| Model | training data                          | testing                 | accuracy(Poisson) | RPS(Poisson)        | accuracy(Logi) | RPS(Logi)                |
| ----- | -------------------------------------- | ----------------------- | ----------------- | ------------------- | -------------- | ------------------------ |
| M1    | season 2020 -2021 data except playoffs | season 2020 playoffs 85 | 0.6352941         | 0.22862(0.10172)    | 0.6235294      | 0.23382( 0.11825)        |
|       | 2019 -2020                             | season 2019,83          | 0.5542169         | 0.23995(0.11819)    | 0.6385542      | 0.235342(0.1408508)      |
|       | 2018-2019                              | 2018,82                 | 0.6463415         | 0.22586(0.11260)    | 0.6341463      | 0.2234996(0.1465644)     |
|       | **2017-2018**                          | **2017,82**             | **0.6341463**     | **0.22479(0.1173)** | **0.6585366**  | **0.2134947(0.1447523)** |
|       | 2016-2017                              | 2016,                   | 0.6455696         | 0.20824(0.11485)    | 0.6835443      | 0.2031052(0.1372898)     |
|       | 2015-2016                              | n=100                   | 0.65              | 0.21069(0.12455)    | 0.67           | 0.2168(0.19616)          |
|       | 2014-2015                              |                         | 0.67368           | 0.20947(0.11775)    | 0.6842105      | 0.20327(0.15214)         |
|       | 2013-2014                              |                         | 0.6179775         | 0.24136(0.11374)    | 0.6404494      | 0.23952(0.1532)          |
|       | 2012-2013                              | 85                      | 0.6941176         | 0.21264(0.12435)    | 0.7176471      | 0.20763(0.16979)         |
|       | 2011-2012                              | 84                      | 0.7261905         | 0.20422(0.09573)    | 0.7261905      | 0.20473(0.1391)          |
|       | 2010-2011                              | 81                      | 0.6790123         | 0.22501(0.1348)     | 0.6419753      | 0.21617(0.16856)         |
|       | 2009-2010                              | 82                      | 0.695122          | 0.21548(0.10174)    | 0.6463415      | 0.20734(0.14296)         |
|       | 2008-2009                              | 85                      | 0.7058824         | 0.2113(0.11692)     | 0.7176471      | 0.20189(0.16597)         |
|       | 2007-2008                              | 86                      | 0.6860465         | 0.2145(0.12346)     | 0.6744186      | 0.20487(0.15687)         |
|       | 2006-2007                              | 79                      | 0.721519          | 0.20561(0.11714)    | 0.6582278      | 0.21437(0.1406)          |
|       | 2005-2006                              | 89                      | 0.5730337         | 0.22376(0.11197)    | 0.5842697      | 0.22012(0.15245)         |
|       | 2004-2005                              | 84                      | 0.6309524         | 0.21695(0.11641)    | 0.6309524      | 0.21708(0.14818)         |



m1:

```R
basketball.inla = inla(y~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season, data = data, family = "poisson",control.compute=list(config = TRUE,cpo = TRUE,dic = TRUE),control.predictor = list(compute = TRUE))

basketball.inla.logi = inla(y.binary~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season , data = data, family = "binomial",Ntrials = 1,control.compute=list(config = TRUE,dic=TRUE,cpo=TRUE),control.predictor = list(compute = TRUE),num.threads = 2)
```



M2: 

## 2.multiple seasons

first row: simple model without random effects, 9min for Poisson

second row: with iid random effect

|                             | training                 | testing                  | Poisson acc | RPS Poisson      | Logi Acc  | RPS Logi         |
| --------------------------- | ------------------------ | ------------------------ | ----------- | ---------------- | --------- | ---------------- |
| total: 24411, n.test = 2325 | [2004-10-22, 2020-10-12) | [2020-10-12, 2022-03-12] | 0.551828    | 0.25712(0.15801) | 0.5870968 | 0.24331(0.14026) |
|                             |                          |                          |             |                  |           |                  |

### 2.1 2019 playoff (w/o random eff)

for 2019 playoff(without random effect)

No improvement at all

| total/test | 2019      | dic      | 0.5542169 | 0.23995(0.11819)  | 0.6385542 | 0.235342(0.14085)   | dic      |
| ---------- | --------- | -------- | --------- | ----------------- | --------- | ------------------- | -------- |
| 2619/83    | 2018:2019 | 39536.67 | 0.5301205 | 0.25462(0.11205)  | 0.5783133 | 0.25879( 0.14081)   | 6350.532 |
| 4001/83    | 2017:2019 | 61046.52 | 0.5060241 | 0.2646(0.11916)   | 0.4819277 | 0.26049(0.13485)    | 9878.102 |
| 5406/83    | 2016:2019 | 82820.12 | 0.5060241 | 0.26648(0.13284)  | 0.4819277 | 0.25902(0.13082)    | 13546.4  |
| 6822/83    | 2015:2019 | 104737   | 0.4939759 | 0.26264(0.13248)  | 0.5903614 | 0.25587(0.12705)    | 17108.25 |
| 8240       | 2014:2019 | 126701.9 | 0.5060241 | 0.27067(0.14777)  | 0.5662651 | 0.25722\(0.12693)   | 20700.49 |
| 9667       | 2013:2019 | 148624.9 | 0.4939759 | 0.27099(0.14871)  | 0.5903614 | 0.25604(0.12181)    | 24384.83 |
| 11087      | 2012:2019 | 170519.1 | 0.4698795 | 0.26844 ( 0.14583 | 0.5421687 | 0.25233 ( 0.11737 ) | 27982.17 |
| 12191      | 2011:2019 | 187549.9 | 0.4698795 | 0.2648 ( 0.14278  | 0.5542169 | 0.24963 ( 0.11136 ) | 30843.34 |
| 13613      | 2010:2019 | 209637.3 | 0.5180723 | 0.2615 ( 0.13698  | 0.5542169 | 0.24676 ( 0.10487 ) | 34491.92 |
| 15037      | 2009:2019 | 231594   | 0.5060241 | 0.25864 ( 0.13242 | 0.5542169 | 0.24361 ( 0.10171 ) | 38153.44 |
| 16462      | 2008:2019 | 254026.3 | 0.5180723 | 0.25775 ( 0.13007 | 0.5542169 | 0.24203 ( 0.0997 )  | 41777.72 |
| 17873      | 2007:2019 | 276277   | 0.5180723 | 0.25931 ( 0.13469 | 0.5542169 | 0.24276 ( 0.10203 ) | 45385.04 |
| 19292      | 2006:2019 | 298624.2 | 0.4939759 | 0.26384 ( 0.14187 | 0.5542169 | 0.24287 ( 0.10023 ) | 49141.88 |
| 20724      | 2005:2019 | 320835   | 0.4578313 | 0.26625 ( 0.14661 | 0.5542169 | 0.24243 ( 0.09987 ) | 52908.38 |
| 22086      | 2004:2019 | 341671.9 | 0.4698795 | 0.2682 ( 0.14997  | 0.5301205 | 0.24317 ( 0.10045 ) | 56383.09 |

with both a&d

best: 4&5 seasons for poisson,  4,5,6,7 seasons for lr.

|           | dic      | poisson       | rps               | lr        | rps                 | dic      |
| --------- | -------- | ------------- | ----------------- | --------- | ------------------- | -------- |
| 2019      |          | 0.5542169     | 0.23995(0.11819)  | 0.6385542 | 0.235342(0.14085)   |          |
| 2018:2019 | 39530.82 | 0.5180723     | 0.25398 ( 0.11202 | 0.5783133 | 0.25896 ( 0.14172 ) | 6350.663 |
| 2017:2019 | 60679.99 | 0.5421687     | 0.2462 ( 0.11496  | 0.4819277 | 0.26077 ( 0.1356 )  | 9878.263 |
| 2016:2019 | 82081.9  | **0.5783133** | 0.24514 ( 0.11698 | 0.6024096 | 0.25246 ( 0.1468 )  | 13285.31 |
| 2015:2019 | 103649.7 | 0.5783133     | 0.2457 ( 0.11951  | 0.6024096 | 0.25048 ( 0.14969 ) | 16534.92 |
| 2014:2019 | 125213.8 | 0.5662651     | 0.2454 ( 0.12112  | 0.5903614 | 0.25074 ( 0.15071 ) | 19920.14 |
| 2013:2019 | 146798.9 | 0.5662651     | 0.24534 ( 0.12014 | 0.6024096 | 0.2498 ( 0.1505 )   | 23384.42 |
| 2012:2019 | 168306.8 | 0.5662651     | 0.24616 ( 0.12314 | 0.5783133 | 0.25075 ( 0.15665   | 26774.87 |
| 2011:2019 | 184952.2 | 0.5421687     | 0.24556 ( 0.12392 | 0.5783133 | 0.25062 ( 0.15682 ) | 29407.54 |
| 2010:2019 | 206423.4 | 0.5421687     | 0.24635 ( 0.12645 | 0.5783133 | 0.25146 ( 0.15992 ) | 32791.29 |
| 2009:2019 | 227836   | 0.5421687     | 0.24585 ( 0.12632 | 0.5783133 | 0.2516 ( 0.16173 )  | 36142.63 |
| 2008:2019 | 249529   | 0.5542169     | 0.24578 ( 0.12647 | 0.5783133 | 0.25155 ( 0.1628 )  | 39421.91 |
| 2007:2019 | 271106.1 | 0.5542169     | 0.24635 ( 0.12871 | 0.5783133 | 0.25182 ( 0.16459 ) | 42702.6  |
| 2006:2019 | 292798.1 | 0.5542169     | 0.24639 ( 0.12839 | 0.5783133 | 0.2515 ( 0.16402 )  | 46313.96 |
| 2005:2019 | 314451   | 0.5542169     | 0.24648 ( 0.12897 | 0.5783133 | 0.25142 ( 0.16433 ) | 49865.47 |
| 2004:2019 | 334949.5 | 0.5542169     | 0.24654 ( 0.12907 | 0.5783133 | 0.25189 ( 0.16458 ) | 53084.67 |

with only attack

| 2019      |          | 0.5542169 | 0.23995(0.11819)  | 0.6385542 | 0.235342(0.14085)   |          |
| --------- | -------- | --------- | ----------------- | --------- | ------------------- | -------- |
| 2018:2019 | 39534.14 | 0.5180723 | 0.25453 ( 0.11225 | 0.5783133 | 0.25921 ( 0.14229 ) | 6350.608 |
| 2017:2019 | 60868.98 | 0.4457831 | 0.26003 ( 0.12371 | 0.4819277 | 0.26105 ( 0.13635 ) | 9878.222 |
| 2016:2019 | 82533.18 | 0.4578313 | 0.26418 ( 0.14105 | 0.4819277 | 0.25928 ( 0.13196 ) | 13546.48 |
| 2015:2019 | 104246.8 | 0.4939759 | 0.26363 ( 0.14596 | 0.5542169 | 0.25371 ( 0.11934 ) | 16969.02 |
| 2014:2019 | 125956.7 | 0.4939759 | 0.26735 ( 0.15238 | 0.5542169 | 0.25434 ( 0.11773 ) | 20506.52 |
| 2013:2019 | 147803.1 | 0.4698795 | 0.26963 ( 0.15351 | 0.5903614 | 0.25253 ( 0.1104 )  | 24157.98 |
| 2012:2019 | 169495.1 | 0.4698795 | 0.26969 ( 0.15249 | 0.5542169 | 0.25084 ( 0.10925 ) | 27701.63 |
| 2011:2019 | 186361.2 | 0.4698795 | 0.26755 ( 0.15005 | 0.5542169 | 0.24913 ( 0.10547 ) | 30500.83 |
| 2010:2019 | 208295   | 0.4698795 | 0.26499 ( 0.14854 | 0.5662651 | 0.24737 ( 0.10267 ) | 34084.21 |
| 2009:2019 | 230107.4 | 0.5180723 | 0.26237 ( 0.1486  | 0.5662651 | 0.24554 ( 0.10131 ) | 37678.85 |
| 2008:2019 | 252368.5 | 0.5421687 | 0.26277 ( 0.14823 | 0.5542169 | 0.24475 ( 0.10029 ) | 41257.73 |
| 2007:2019 | 274466.2 | 0.5421687 | 0.26522 ( 0.15433 | 0.5542169 | 0.24486 ( 0.10149 ) | 44792.98 |
| 2006:2019 | 296517.3 | 0.5421687 | 0.26792 ( 0.15681 | 0.5542169 | 0.24491 ( 0.09964 ) | 48520.1  |
| 2005:2019 | 318521.8 | 0.5180723 | 0.26996 ( 0.15916 | 0.5542169 | 0.24444 ( 0.09868 ) | 52239.99 |
| 2004:2019 | 339275.8 | 0.5180723 | 0.27191 ( 0.15967 | 0.5542169 | 0.24463 ( 0.09821 ) | 55647.45 |



### 2.2 2018 playoff (w/o random eff)

for 2018 playoff(without random effect)

best 3 for poisson, 2,3,4, 7for lr .   compared with single season data, 1%/4% increase.

|         | 2018(playoffs happen in 2019) | dic      | 0.6463415(baseline) | 0.22586(0.11260) | 0.6341463     | 0.2234996(0.1465644) | dic      |
| ------- | ----------------------------- | -------- | ------------------- | ---------------- | ------------- | -------------------- | -------- |
| 2760/82 | 2017:2018                     | 41447.14 | 0.6341463           | 0.2282(0.10695)  | **0.6707317** | **0.21936(0.13416)** | 6653.234 |
| 4165    | 2016:2018                     | 63127.13 | **0.6585366**       | 0.23023(0.12484) | **0.6707317** | 0.21957(0.13515)     | 10268.19 |
| 5581    | 2015:2018                     | 84995.5  | 0.597561            | 0.23573(0.13346) | **0.6707317** | 0.22556(0.14275)     | 13773.29 |
| 6999    | 2014:2018                     | 106909   | 0.5731707           | 0.23571(0.13535) | 0.6341463     | 0.22596(0.14274)     | 17341.83 |
| 8426    | 2013:2018                     | 128809.4 | 0.5853659           | 0.23807(0.13628) | 0.6219512     | 0.23117(0.13655)     | 21022.18 |
|         | 2012:2018                     | 150681   | 0.6219512           | 0.24003 (0.13502 | **0.6707317** | 0.23325 ( 0.13268 )  | 24632.58 |
|         | 2011:2018                     | 167718.4 | 0.6463415           | 0.23945 (0.13101 | 0.6463415     | 0.23591 ( 0.12347 )  | 27511.97 |
|         | 2010:2018                     | 189811.9 | 0.5853659           | 0.23975 (0.12472 | 0.6463415     | 0.23694 ( 0.11799 )  | 31170.76 |
|         | 2009:2018                     | 211771.3 | 0.5487805           | 0.24065 (0.11906 | 0.6341463     | 0.23627 ( 0.11044 )  | 34846.62 |
|         | 2008:2018                     | 234180.3 | 0.5243902           | 0.23965 (0.11359 | 0.6341463     | 0.23585 ( 0.10633 )  | 38477.05 |
|         | 2007:2018                     | 256403.6 | 0.5609756           | 0.23855 (0.11313 | 0.597561      | 0.23577 ( 0.10744 )  | 42081.69 |
|         | 2006:2018                     | 278721.5 | 0.5731707           | 0.24125 (0.11232 | 0.5853659     | 0.23622 ( 0.10591 )  | 45833.62 |
|         | 2005:2018                     | 300910.6 | 0.5365854           | 0.24467 (0.11255 | 0.59756       | 0.23816 ( 0.10303 )  | 49598.68 |
|         | 2004:2018                     | 321729.2 | 0.4878049           | 0.24655 (0.11416 | 0.5853659     | 0.23916 ( 0.10254 )  | 53068.02 |

with only attack random effect

best 3 for poisson, 3 for lr.

compared to single season, 2%/5% increase.

|      | 2018 single | dic      | 0.6463415(baseline) | 0.22586(0.11260)  | 0.6341463     | 0.2234996(0.1465644) | dic      |
| ---- | ----------- | -------- | ------------------- | ----------------- | ------------- | -------------------- | -------- |
|      | 2017:2018   | 41445.38 | 0.6341463           | 0.22814 ( 0.10716 | 0.6707317     | 0.21916 ( 0.13497 )  | 6653.415 |
|      | 2016        | 63121.99 | **0.6707317**       | 0.23 ( 0.12519    | **0.6829268** | 0.21938 ( 0.13604 )  | 10268.31 |
|      | 2015        | 84679.77 | 0.5731707           | 0.23081 ( 0.13852 | 0.6707317     | 0.22549 ( 0.14293 )  | 13773.37 |
|      | 2014        | 106359.7 | 0.5731707           | 0.23033 ( 0.13823 | 0.6707317     | 0.22413 ( 0.13182 )  | 17195.85 |
|      | 2013        | 128183   | 0.5731707           | 0.23193 ( 0.13817 | 0.6463415     | 0.22777 ( 0.12292 )  | 20832.01 |
|      | 2012        | 149865.3 | 0.5731707           | 0.23271 ( 0.13559 | 0.6585366     | 0.22966 ( 0.11813 )  | 24383.98 |
|      | 2011        | 166750   | 0.5731707           | 0.23023 ( 0.13021 | 0.6585366     | 0.23124 ( 0.10977 )  | 27198.49 |
|      | 2010        | 188693.6 | 0.5609756           | 0.23035 ( 0.12945 | 0.6585366     | 0.23164 ( 0.10575 )  | 30790.48 |
|      | 2009        | 210511.9 | 0.597561            | 0.23264 ( 0.12932 | 0.6341463     | 0.23146 ( 0.10077 )  | 34395.95 |
|      | 2008        | 232756.4 | 0.597561            | 0.23331 ( 0.12888 | 0.6341463     | 0.23132 ( 0.09811 )  | 37980    |
|      | 2007        | 254832.2 | 0.6341463           | 0.23418 ( 0.13382 | 0.6219512     | 0.23154 ( 0.09856 )  | 41513.26 |
|      | 2006        | 276868   | 0.6341463           | 0.236 ( 0.13568   | 0.6097561     | 0.23205 ( 0.09693 )  | 45236.93 |
|      | 2005        | 298855.9 | 0.6097561           | 0.23771 ( 0.13484 | 0.597561      | 0.23319 ( 0.09421 )  | 48957.13 |
|      | 2004        | 319594.2 | 0.6097561           | 0.23973 ( 0.13372 | 0.5853659     | 0.23374 ( 0.0936 )   | 52363.01 |

with two random effects

best, 6 seasons for poisson, 3,4 seasons for lr.  1% for poisson. 5% for lr

| 2018      | dicdic   | 0.6463415(baseline) | 0.22586(0.11260)  | 0.6341463     | 0.2234996(0.1465644) | dic      |
| --------- | -------- | ------------------- | ----------------- | ------------- | -------------------- | -------- |
| 2017:2018 | 41441.69 | 0.6341463           | 0.22813 ( 0.10661 | 0.6707317     | 0.2193 ( 0.13429 )   | 6653.481 |
| 2016      | 62844.13 | 0.6341463           | 0.23286 ( 0.11521 | **0.6829268** | 0.21937 ( 0.13601 )  | 10268.36 |
| 2015      | 84445.25 | 0.6219512           | 0.23283 ( 0.11589 | **0.6829268** | 0.21791 ( 0.13581 )  | 13537.27 |
| 2014      | 105908.8 | 0.6463415           | 0.22744 ( 0.10621 | 0.6585366     | 0.21802 ( 0.12836 )  | 16846.97 |
| 2013      | 127493.8 | **0.6585366**       | 0.22749 ( 0.10471 | 0.6585366     | 0.21813 ( 0.12645 )  | 20299.97 |
| 2012      | 148997.2 | 0.6585366           | 0.22678 ( 0.10728 | 0.6585366     | 0.21866 ( 0.13003 )  | 23686.03 |
| 2011      | 165637.7 | 0.6585366           | 0.2273 ( 0.10766  | 0.6585366     | 0.21865 ( 0.13072 )  | 26314.8  |
| 2010      | 187107.4 | 0.6585366           | 0.22749 ( 0.10928 | 0.6707317     | 0.21861 ( 0.13377 )  | 29694.66 |
| 2009      | 208518.3 | 0.6585366           | 0.22695 ( 0.10899 | 0.6707317     | 0.21901 ( 0.1343 )   | 33043.02 |
| 2008      | 230210.6 | 0.6585366           | 0.22686 ( 0.1095  | 0.6707317     | 0.21913 ( 0.13496 )  | 36321.2  |
| 2007      | 251784.5 | 0.6585366           | 0.22729 ( 0.11173 | 0.6707317     | 0.21928 ( 0.13602 )  | 39599.47 |
| 2006      | 273475.9 | 0.6585366           | 0.22695 ( 0.11164 | 0.6707317     | 0.21919 ( 0.1355 )   | 43211.13 |
| 2005      | 295129   | 0.6585366           | 0.22711 ( 0.11191 | 0.6707317     | 0.21927 ( 0.13561 )  | 46762.21 |
| 2004      | 315625.6 | 0.6585366           | 0.22727 ( 0.11268 | 0.6707317     | 0.21959 ( 0.13597 )  | 49983.28 |



### 2.3 2017 playoff (w/o random eff)

multiple seasons for the **2017 playoff** (without random effect):

7:10/9    6%/ 6%

|                     |                | dic      | **0.6341463 **(baseline) |                  | 0.6585366 (baseline) |                   | dic      |
| ------------------- | -------------- | -------- | ------------------------ | ---------------- | -------------------- | ----------------- | -------- |
| total:2787, test:82 | 2016&2017      | 41527.36 | **0.695122**             | 0.21034(0.09452) | 0.7073171            | 0.19788(0.12181)  | 6800.439 |
| total:4203, test:82 | 2015&2016&2017 | 63343.42 | 0.6341463                | 0.21956(0.10783) | 0.6707317            | 0.2033(0.13631)   | 10254.03 |
| total:5621, test:82 | 2014:2017      | 85247.9  | 0.6463415                | 0.21936(0.10394) | 0.7073171            | 0.19994(0.13313)  | 13780.16 |
| 7048; 82            | 2013:2017      | 107105.5 | 0.6463415                | 0.21852(0.10672) | 0.7073171            | 0.20654(0.12561)  | 17438.31 |
| 8468;82             | 2012:2017      | 128946.9 | 0.6341463                | 0.21684(0.10579) | 0.695122             | 0.20864(0.12278)  | 21056.87 |
| 9572;82             | 2011:2017      | 145974   | **0.695122**             | 0.21791(0.10717) | 0.695122             | 0.2124(0.11879)   | 23935.96 |
|                     | 2010：2017     | 168041   | **0.695122**             | 0.21673 (0.10836 | 0.6585366            | 0.21358 (0.11883) | 27585.91 |
|                     | 2009：2017     | 189983.8 | **0.695122**             | 0.2186 ( 0.10737 | **0.7195122**        | 0.21348 (0.11355) | 31255.56 |
|                     | 2008:2017      | 212378.2 | **0.695122**             | 0.21972 (0.11195 | 0.695122             | 0.21238 (0.11058) | 34882.19 |
|                     | 2007:2017      | 234569.7 | 0.6463415                | 0.22042 (0.11923 | 0.695122             | 0.20922 (0.10759) | 38491.62 |
|                     | 2006:2017      | 256841.5 | 0.6463415                | 0.22215 (0.12305 | 0.6707317            | 0.20863(0.10478)  | 42239.32 |
|                     | 2005:2017      | 279037.1 | 0.6463415                | 0.22287 (0.12491 | 0.6707317            | 0.209 ( 0.10146 ) | 46000.52 |
| 19467               | 2004：2017     | 299857.2 | 0.6341463                | 0.22405 (0.12969 | 0.695122             | 0.2101 (0.10297 ) | 49465.7  |

### 2.4 2017 with the random effect 

#### 2.4.1 both on a&d

​     6%/5%

| total game |           | dic          | Poisson                  |                   | LR                   |                                    |
| ---------- | --------- | ------------ | ------------------------ | ----------------- | -------------------- | ---------------------------------- |
|            |           | dic          | **0.6341463 **(baseline) |                   | 0.6585366 (baseline) |                                    |
| 2787       | 2016:2017 | 41522.35     | **0.695122**             | 0.21053(0.09494)  | 0.695122             | 0.19776( 0.12275 ) , dic: 6800.538 |
| 4203       | 2015:2017 | 63093.19     | 0.6585366                | 0.21817(0.11182)  | 0.6707317            | 0.20336( 0.13648 ) , dic:10254.21  |
| 5621       | 2014:2017 | 84576.02     | 0.6585366                | 0.21792(0.10999)  | 0.7073171            | 0.19816( 0.1277 ), dic: 13582.26   |
| 7048       | 2013:2017 | 106156.3     | **0.6829268**            | 0.21799(0.10958)  | 0.695122             | 0.19948(0.1265), dic:17084.7       |
| 8468       | 2012:2017 | 127664.4     | **0.6829268**            | 0.21749(0.11252)  | 0.6829268            | 0.20014(0.12783), dic: 20332.51    |
| 9572       | 2011:2017 | 144304.4     | 0.6829268                | 0.21733(0.11321)  | 0.6829268            | 0.20049(0.12947 ), dic:22957.9     |
| 10994      | 2010      | 165776.3     | 0.6829268                | 0.21632 ( 0.11587 | **0.7073171**        | 0.19992 ( 0.13194 ) 26335.44       |
| 12418      | 2009      | 187190.1     | 0.6707317                | 0.21645 ( 0.11647 | 0.6829268            | 0.19985 ( 0.13298 ) 29684.88       |
| 13843      | 2008      | 208882.5     | 0.6829268                | 0.21599 ( 0.11679 | **0.7073171**        | 0.1996 ( 0.13321 ) 32962.4         |
| 15254      | 2007      | 230456.8     | 0.6585366                | 0.21555 ( 0.11756 | 0.6829268            | 0.19957 ( 0.13462 ) 36240.37       |
| 16673      | 2006      | 252149.1     | 0.6463415                | 0.21573 ( 0.11972 | **0.6829268**        | 0.19986 ( 0.13454 ) 39853.04       |
| 18105      | 2005      | 273802.7     | 0.6219512                | 0.21569 ( 0.11983 | **0.6829268**        | 0.1997 ( 0.13434 ) 43404.17        |
| 19467      | 2004      | 294298**.2** | 0.6463415                | 0.21532 ( 0.11944 | 0.6829268            | 0.19978 ( 0.13552 ) 46624.11       |

#### 2.4.2 with only attack

10%/5%

|          |      | **0.6341463 **(baseline) |                   | 0.6585366 (baseline) |                     |          |
| -------- | ---- | ------------------------ | ----------------- | -------------------- | ------------------- | -------- |
| 41526.03 | 2016 | 0.695122                 | 0.21043 ( 0.09473 | 0.695122             | 0.19775 ( 0.12293 ) | 6800.538 |
| 63167.07 | 2015 | 0.6219512                | 0.21597 ( 0.10332 | 0.6463415            | 0.20333 ( 0.1373 )  | 10254.15 |
| 84836.17 | 2014 | 0.6707317                | 0.21261 ( 0.09874 | **0.7073171**        | 0.19987 ( 0.13374 ) | 13780.26 |
| 106644.4 | 2013 | 0.695122                 | 0.20979 ( 0.0933  | 0.7195122            | 0.20653 ( 0.12539 ) | 17757.68 |
| 128324.9 | 2012 | **0.7317073**            | 0.20826 ( 0.08999 | 0.695122             | 0.20751 ( 0.11186 ) | 20864.69 |
| 145206.8 | 2011 | 0.6707317                | 0.20804 ( 0.09165 | 0.695122             | 0.20984 ( 0.10774 ) | 23675.28 |
| 167150.8 | 2010 | 0.7195122                | 0.20595 ( 0.09095 | 0.695122             | 0.21108 ( 0.10742 ) | 27260.49 |
| 188965.1 | 2009 | 0.7195122                | 0.20838 ( 0.08933 | 0.7073171            | 0.21143 ( 0.1045 )  | 30861.92 |
| 211199.7 | 2008 | 0.7317073                | 0.21105 ( 0.09826 | 0.7073171            | 0.21078 ( 0.10336 ) | 34442.89 |
| 233256.9 | 2007 | 0.7317073                | 0.21261 ( 0.10953 | 0.7073171            | 0.20871 ( 0.10289   | 37979.55 |
| 255282.8 | 2006 | 0.695122                 | 0.21502 ( 0.11827 | 0.7073171            | 0.20866 ( 0.09969 ) | 41698.21 |
| 277284.2 | 2005 | 0.695122                 | 0.21363 ( 0.11872 | 0.7073171            | 0.20896 ( 0.0963 )  | 45413.79 |
| 298029.1 | 2004 | 0.695122                 | 0.21388 ( 0.12025 | 0.6829268            | 0.21003 ( 0.09649 ) | 48814.68 |

### 2 appendix

code for 2.4.1

```R
basketball.inla.logi = inla(y.binary~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season
                            + f(a.season, model = "generic0", Cmatrix = Q.a, rankdef = 1, constr = TRUE) +f(d.season, model = "generic0",Cmatrix = Q.d, rankdef = 1, constr = TRUE)
                            , data = data, family = "binomial",Ntrials = 1,control.compute=list(config = TRUE,dic=TRUE,cpo=TRUE),control.predictor = list(compute = TRUE),num.threads = 2)
```

```R
basketball.inla = inla(y~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season
                     + f(a.season, model = "generic0", Cmatrix = Q.a, rankdef = 1, constr = TRUE) + f(d.season, model = "generic0", Cmatrix = Q.d, rankdef = 1, constr = TRUE) 
                     
                     , data = data, family = "poisson",control.compute=list(config = TRUE,cpo = TRUE,dic = TRUE),control.predictor = list(compute = TRUE),verbose = FALSE)
```



## 3. predict a whole season



about 8 mins to run a model.

|           | poisson w/o re                                 | logi w/o re                                    | poisson with re                                | logi with re                                   |
| --------- | ---------------------------------------------- | ---------------------------------------------- | ---------------------------------------------- | ---------------------------------------------- |
| 2014-2015 | 0.6257  0.6289  0.6335  0.6389  0.6494  0.6582 | 0.6321  0.6434  0.6490  0.6489  0.6547  0.6617 | 0.6490  0.6497  0.6504  0.6522  0.6550  0.6575 | 0.6299  0.6522  0.6532  0.6526  0.6550  0.6617 |
| 2015-2016 | 0.6028  0.6078  0.6160  0.6190  0.6281  0.6505 | 0.6214  0.6260  0.6313  0.6304  0.6345  0.6391 | 0.6342  0.6367  0.6377  0.6406  0.6445  0.6505 | 0.6313  0.6327  0.6335  0.6368  0.6377  0.6505 |
|           |                                                |                                                |                                                |                                                |
|           |                                                |                                                |                                                |                                                |
|           |                                                |                                                |                                                |                                                |
|           |                                                |                                                |                                                |                                                |
|           |                                                |                                                |                                                |                                                |
|           |                                                |                                                |                                                |                                                |
|           |                                                |                                                |                                                |                                                |

## 4. with dependency for outcomes

2017 playoff poisson regression 

| total game |           | dic          | with attack and defend   | wIth a/d and dependency term |           | with only attack | with attack+ dependency term |
| ---------- | --------- | ------------ | ------------------------ | ---------------------------- | --------- | ---------------- | ---------------------------- |
|            |           | dic          | **0.6341463 **(baseline) |                              |           |                  |                              |
| 2787       | 2016:2017 | 41522.35     | **0.695122**             | 41019.13                     | 0.695122  | 0.695122         |                              |
| 4203       | 2015:2017 | 63093.19     | 0.6585366                | 62419.74                     | 0.6585366 | 0.6219512        |                              |
| 5621       | 2014:2017 | 84576.02     | 0.6585366                | 83608.43                     | 0.6463415 | 0.6707317        |                              |
| 7048       | 2013:2017 | 106156.3     | 0.6829268                | 104972.6                     | 0.6585366 | 0.695122         |                              |
| 8468       | 2012:2017 | 127664.4     | 0.6829268                | 126161.2                     | 0.6707317 | **0.7317073**    |                              |
| 9572       | 2011:2017 | 144304.4     | 0.6829268                | 142592.2                     | 0.6829268 | 0.6707317        |                              |
| 10994      | 2010      | 165776.3     | 0.6829268                | 163804.2                     | 0.6829268 | 0.7195122        |                              |
| 12418      | 2009      | 187190.1     | 0.6707317                | 185039.6                     | 0.6829268 | 0.7195122        |                              |
| 13843      | 2008      | 208882.5     | 0.6829268                | 206402.6                     | 0.6829268 | **0.7317073**    |                              |
| 15254      | 2007      | 230456.8     | 0.6585366                | 227613.9                     | 0.6585366 | **0.7317073**    |                              |
| 16673      | 2006      | 252149.1     | 0.6463415                | 248919.5                     | 0.6829268 | 0.695122         |                              |
| 18105      | 2005      | 273802.7     | 0.6219512                | 270258.3                     | 0.6585366 | 0.695122         |                              |
| 19467      | 2004      | 294298**.2** | 0.6463415                | 290496.4                     | 0.6585366 | 0.695122         |                              |

#### Gaussian regression

