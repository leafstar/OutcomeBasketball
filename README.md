

# OutcomeBasketball

Master Project

Using INLA to predict the outcome of basketball matches.

games2021_v2.csv: adding the average statistics before the current game in this season for both teams. 

Dataset Specification: mm/dd/yyyy

| Season | Starting date | Ending date | Playoff starts |
| ------ | ------------- | ----------- | -------------- |
| 2021   | 10/3/2021     | 3/12/2022   |                |
| 2020   | 12/11/2020    | 7/20/2021   |                |
| 2019   | 10/4/2019     | 10/11/2020  |                |
| 2018   | 9/28/2018     | 6/13/2019   |                |
| 2017   | 9/30/2017     | 6/8/2018    |                |
| 2016   | 10/1/2016     | 6/12/2017   |                |
| 2015   | 10/2/2015     | 6/19/2016   |                |
| 2014   | 10/4/2014     | 6/16/2015   |                |
| 2013   | 10/5/2013     | 6/15/2014   |                |
| 2012   | 10/6/2012     | 6/20/2013   |                |
| 2011   | 12/16/2011    | 6/21/2012   |                |
| 2010   | 10/4/2010     | 6/12/2011   |                |
| 2009   | 10/1/2009     | 6/17/2010   |                |
| 2008   | 10/5/2008     | 6/14/2009   |                |
| 2007   | 10/6/2007     | 6/17/2008   |                |
| 2006   | 10/9/2006     | 6/14/2007   |                |
| 2005   | 10/10/2005    | 6/20/2006   |                |
| 2004   | 10/22/2004    | 6/23/2005   |                |
| 2003   | 10/5/2003     | 6/15/2004   |                |

experiment record:

## 1.single season

| Model | training data                          | testing                 | accuracy(Poisson) | RPS(Poisson)        | accuracy(Logi) | RPS(Logi)                |
| ----- | -------------------------------------- | ----------------------- | ----------------- | ------------------- | -------------- | ------------------------ |
| M1    | season 2020 -2021 data except playoffs | season 2020 playoffs 85 | 0.6352941         | 0.22862(0.10172)    | 0.6235294      | 0.23382( 0.11825)        |
|       | 2019 -2020                             | season 2019,83          | 0.5542169         | 0.23995(0.11819)    | 0.6385542      | 0.235342(0.1408508)      |
|       | 2018-2019                              | 2018,82                 | 0.6463415         | 0.22586(0.11260)    | 0.6341463      | 0.2234996(0.1465644)     |
|       | **2017-2018**                          | **2017,82**             | **0.6341463**     | **0.22479(0.1173)** | **0.6585366**  | **0.2134947(0.1447523)** |
|       | 2016-2017                              | 2016,                   | 0.6455696         | 0.20824(0.11485)    | 0.6835443      | 0.2031052(0.1372898)     |
|       | 2015-2016                              | n=100                   | 0.65              | 0.21069(0.12455)    | 0.67           | 0.2168(0.19616)          |
|       | 2014-2015                              |                         | 0.67368           | 0.20947(0.11775)    | 0.6842105      | 0.20327(0.15214)         |
|       | 2013-2014                              |                         | 0.6179775         | 0.24136(0.11374)    | 0.6404494      | 0.23952(0.1532)          |
|       | 2012-2013                              | 85                      | 0.6941176         | 0.21264(0.12435)    | 0.7176471      | 0.20763(0.16979)         |
|       | 2011-2012                              | 84                      | 0.7261905         | 0.20422(0.09573)    | 0.7261905      | 0.20473(0.1391)          |
|       | 2010-2011                              | 81                      | 0.6790123         | 0.22501(0.1348)     | 0.6419753      | 0.21617(0.16856)         |
|       | 2009-2010                              | 82                      | 0.695122          | 0.21548(0.10174)    | 0.6463415      | 0.20734(0.14296)         |
|       | 2008-2009                              | 85                      | 0.7058824         | 0.2113(0.11692)     | 0.7176471      | 0.20189(0.16597)         |
|       | 2007-2008                              | 86                      | 0.6860465         | 0.2145(0.12346)     | 0.6744186      | 0.20487(0.15687)         |
|       | 2006-2007                              | 79                      | 0.721519          | 0.20561(0.11714)    | 0.6582278      | 0.21437(0.1406)          |
|       | 2005-2006                              | 89                      | 0.5730337         | 0.22376(0.11197)    | 0.5842697      | 0.22012(0.15245)         |
|       | 2004-2005                              | 84                      | 0.6309524         | 0.21695(0.11641)    | 0.6309524      | 0.21708(0.14818)         |



m1:

```R
basketball.inla = inla(y~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season, data = data, family = "poisson",control.compute=list(config = TRUE,cpo = TRUE,dic = TRUE),control.predictor = list(compute = TRUE))

basketball.inla.logi = inla(y.binary~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season , data = data, family = "binomial",Ntrials = 1,control.compute=list(config = TRUE,dic=TRUE,cpo=TRUE),control.predictor = list(compute = TRUE),num.threads = 2)
```



M2: 

## 2.multiple seasons

first row: simple model without random effects, 9min for Poisson

second row: with iid random effect

|                             | training                 | testing                  | Poisson acc | RPS Poisson      | Logi Acc  | RPS Logi         |
| --------------------------- | ------------------------ | ------------------------ | ----------- | ---------------- | --------- | ---------------- |
| total: 24411, n.test = 2325 | [2004-10-22, 2020-10-12) | [2020-10-12, 2022-03-12] | 0.551828    | 0.25712(0.15801) | 0.5870968 | 0.24331(0.14026) |
|                             |                          |                          | 0.556129    | 0.24986(0.136)   | 0.5883871 | 0.24329(0.14006) |

### 2.1 2019 playoff (w/o random eff)

for 2019 playoff(without random effect)

| total/test | 2019      |              | 0.5542169 | 0.23995(0.11819) | 0.6385542 | 0.235342(0.14085) |
| ---------- | --------- | ------------ | --------- | ---------------- | --------- | ----------------- |
| 2619/83    | 2018:2019 | 2019 playoff | 0.5301205 | 0.25462(0.11205) | 0.5783133 | 0.25879( 0.14081) |
| 4001/83    | 2017:2019 |              | 0.5060241 | 0.2646(0.11916)  | 0.4819277 | 0.26049(0.13485)  |
| 5406/83    | 2016:2019 |              | 0.5060241 | 0.26648(0.13284) | 0.4819277 | 0.25902(0.13082)  |
| 6822/83    | 2015:2019 |              | 0.4939759 | 0.26264(0.13248) | 0.5903614 | 0.25587(0.12705)  |
| 8240       | 2014:2019 |              | 0.5060241 | 0.27067(0.14777) | 0.5662651 | 0.25722\(0.12693) |
| 9667       | 2013:2019 |              | 0.4939759 | 0.27099(0.14871) | 0.5903614 | 0.25604(0.12181)  |

### 2.2 2018 playoff (w/o random eff)

for 2018 playoff(without random effect)

|      | 2018-2019 | 2018 playoff | 0.6463415(baseline) | 0.22586(0.11260) | 0.6341463 | 0.2234996(0.1465644) |
| ---- | --------- | ------------ | ------------------- | ---------------- | --------- | -------------------- |
| 2760 | 2017:2018 | 82           | 0.6341463           | 0.2282(0.10695)  | 0.6707317 | 0.21936(0.13416)     |
| 4165 | 2016:2018 |              | 0.6585366           | 0.23023(0.12484) | 0.6829268 | 0.21957(0.13515)     |
| 5581 | 2015:2018 |              | 0.597561            | 0.23573(0.13346) | 0.6707317 | 0.22556(0.14275)     |
| 6999 | 2014:2018 |              | 0.5731707           | 0.23571(0.13535) | 0.6341463 | 0.22596(0.14274)     |
| 8426 | 2013:2018 |              | 0.5853659           | 0.23807(0.13628) | 0.6219512 | 0.23117(0.13655)     |

### 2.3 2017 playoff (w/o random eff)

multiple seasons for **2017 playoff** (without random effect):

|                     |                |              | **0.6341463 **(baseline) |                  | 0.6585366 (baseline) |                  |
| ------------------- | -------------- | ------------ | ------------------------ | ---------------- | -------------------- | ---------------- |
| total:2787, test:82 | 2016&2017      | 2017 playoff | 0.695122                 | 0.21034(0.09452) | 0.7073171            | 0.19788(0.12181) |
| total:4203, test:82 | 2015&2016&2017 | 2017 playoff | 0.6341463                | 0.21956(0.10783) | 0.6707317            | 0.2033(0.13631)  |
| total:5621, test:82 | 2014:2017      |              | 0.6585366                | 0.21936(0.10394) | 0.7073171            | 0.19994(0.13313) |
| 7048; 82            | 2013:2017      |              | 0.6463415                | 0.21852(0.10672) | 0.7073171            | 0.20654(0.12561) |
| 8468;82             | 2012:2017      |              | 0.6463415                | 0.21684(0.10579) | 0.695122             | 0.20864(0.12278) |
| 9572;82             | 2011:2017      |              | 0.695122                 | 0.21791(0.10717) | 0.695122             | 0.2124(0.11879)  |
|                     |                |              |                          |                  |                      |                  |

### 2.4 2017 with random effect

#### 2.4.1 with iid random effect:

```R
basketball.inla = inla(y~1+a+d+h+PTS_cur_season+FG_PCT_cur_season+FT_PCT_cur_season+FG3_PCT_cur_season+AST_cur_season+REB_cur_season+WINRATE_cur_season+ PTS_LOST_cur_season+ f(season), data = data, family = "poisson",control.compute=list(config = TRUE,cpo = TRUE,dic = TRUE),control.predictor = list(compute = TRUE))
```

|                     |           |              |           |                  |           |                  |
| ------------------- | --------- | ------------ | --------- | ---------------- | --------- | ---------------- |
|                     | 2016:2017 | 2017 PLAYOFF | 0.695122  | 0.2103(0.09533)  | 0.695122  | 0.19795(0.12094) |
|                     | 2015:2017 |              | 0.6585366 | 0.21567(0.1053)  | 0.6707317 | 0.2033(0.13631)  |
| total:5621, test:82 | 2014:2017 |              | 0.6829268 | 0.21244(0.09984) | 0.7073171 | 0.19996(0.13315) |
|                     | 2013:2017 |              | 0.6585366 | 0.21414(0.10243) | 0.7073171 | 0.20652(0.12549) |
|                     | 2012:2017 |              | 0.6219512 | 0.21337(0.10272) | 0.695122  | 0.20863(0.12282) |
| 9572;82             | 2011:2017 | 2017 playoff | 0.6463415 | 0.21464(0.10226) | 0.695122  | 0.21245(0.11867) |
|                     |           |              |           |                  |           |                  |

#### 2.4.2 with rw random effect:

|         |           |              | rw1/rw2             |                                  |                   |                                  |
| ------- | --------- | ------------ | ------------------- | -------------------------------- | ----------------- | -------------------------------- |
| 2787/82 | 2016:2017 | 2017 playoff | 0.695122            | 0.20999(0.0948)                  | 0.7073171         | 0.19789(0.12199)                 |
| 4203    | 2015:2017 |              | 0.6585366           | 0.21562(0.10503)                 | 0.6707317         | 0.20325(0.13654)                 |
| 5621    | 2014:2017 |              | 0.6829268           | 0.21241(0.09968)                 | 0.7073171         | 0.19999(0.13368)                 |
|         | 2013:2017 |              | 0.6585366           | 0.21398(0.10252)                 | 0.7073171         | 0.20657(0.12537)                 |
|         | 2012:2017 |              | 0.634146            | 0.21317(0.10277)                 | 0.695122          | 0.2086(0.12277)                  |
|         | 2011:2017 |              | 0.6463415/0.6463415 | 0.21454/0.2146(0.10216/0.10211)  | 0.695122/0.695122 | 0.21222/0.21244(0.1191/0.11897)  |
| 19467   | 2004:2017 |              | 0.6585366/0.6585366 | 0.21799/0.21805(0.11646/0.11632) | 0.695122/0.695122 | 0.21024/0.21028(0.10254/0.10206) |

#### 2.4.3 with ar random effect:

## 3. predict a whole season

use 2017 to predict 2018

1378/2760

0.6219158  0.22726(0.15037)

0.6240929 0.23154(0.1811)